import { PlatformPressable } from "@react-navigation/elements";
import { useLinkBuilder, useTheme } from '@react-navigation/native';
import { StyleSheet, Text, View } from "react-native";
import { SvgXml } from "react-native-svg";


const Tapbar = ({ state, descriptors, navigation }) =>
{   
    const { colors } = useTheme();
    const { buildHref } = useLinkBuilder();

    const plane = `<svg fill="#000000" height="800px" width="800px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	 viewBox="0 0 487.1 487.1" xml:space="preserve">
    <g>
        <path d="M487.1,14.065c0-0.1,0-0.2,0-0.4c0-0.3-0.1-0.5-0.1-0.8c0-0.2,0-0.4-0.1-0.6c0-0.2-0.1-0.4-0.1-0.5
            c-0.1-0.2-0.1-0.5-0.2-0.7c0-0.1-0.1-0.2-0.1-0.4c-0.1-0.3-0.2-0.6-0.3-0.9c0-0.1-0.1-0.1-0.1-0.2c-0.1-0.3-0.3-0.7-0.5-1
            c0-0.1-0.1-0.2-0.1-0.2c-0.2-0.3-0.3-0.6-0.5-0.9c-0.7-1-1.5-1.9-2.4-2.7c-3.7-4.2-9.8-5.9-15.3-3.6L8.4,190.765
            c-0.1,0.1-0.3,0.1-0.4,0.2c-0.3,0.1-0.5,0.2-0.8,0.4c-0.2,0.1-0.4,0.2-0.6,0.3s-0.4,0.2-0.6,0.4c-0.2,0.1-0.4,0.3-0.6,0.4
            c-0.2,0.1-0.3,0.2-0.5,0.4c-0.2,0.1-0.3,0.3-0.5,0.5c-0.2,0.1-0.3,0.3-0.5,0.4c-0.2,0.2-0.3,0.3-0.5,0.5c-0.1,0.2-0.3,0.3-0.4,0.5
            c-0.1,0.2-0.3,0.4-0.4,0.5c-0.1,0.2-0.3,0.3-0.4,0.5c-0.1,0.2-0.3,0.4-0.4,0.6c-0.1,0.2-0.2,0.3-0.3,0.5c-0.2,0.3-0.3,0.6-0.4,0.9
            c0,0.1-0.1,0.2-0.2,0.3l0,0c-0.2,0.4-0.3,0.8-0.4,1.2c0,0,0,0,0,0.1c-0.1,0.4-0.2,0.8-0.3,1.3c0,0.2-0.1,0.4-0.1,0.6
            c0,0.2-0.1,0.5-0.1,0.7s0,0.4,0,0.6c0,0.2,0,0.5,0,0.7s0,0.4,0,0.6c0,0.2,0,0.5,0,0.7s0.1,0.4,0.1,0.5c0,0.3,0.1,0.5,0.1,0.8
            c0.1,0.3,0.1,0.6,0.2,0.9c0.1,0.2,0.1,0.4,0.2,0.6c0.1,0.3,0.2,0.7,0.4,1l0,0c0.1,0.4,0.3,0.7,0.5,1c0,0.1,0.1,0.2,0.1,0.2
            c0.1,0.3,0.3,0.5,0.5,0.8c0.1,0.1,0.1,0.2,0.2,0.3c0.2,0.3,0.3,0.5,0.5,0.7c0.1,0.1,0.1,0.2,0.2,0.2c0.3,0.3,0.5,0.6,0.8,0.9l0,0
            c0.3,0.3,0.6,0.5,0.9,0.8c0.1,0.1,0.2,0.2,0.3,0.2c0.2,0.2,0.5,0.4,0.7,0.5c0.1,0.1,0.2,0.1,0.3,0.2c0.3,0.2,0.7,0.4,1,0.6
            c0.1,0,0.1,0.1,0.2,0.1c0.3,0.2,0.6,0.3,1,0.5c0.1,0,0.1,0.1,0.2,0.1l185,78.4l78.4,185c0.1,0.4,0.3,0.7,0.5,1
            c0,0.1,0.1,0.2,0.1,0.2c0.2,0.3,0.3,0.5,0.5,0.8c0.1,0.1,0.1,0.2,0.2,0.3c0.2,0.3,0.4,0.5,0.5,0.7c0.1,0.1,0.1,0.2,0.2,0.2
            c0.3,0.3,0.5,0.6,0.8,0.9l0.1,0.1c0.3,0.2,0.5,0.5,0.8,0.7c0.1,0.1,0.2,0.2,0.3,0.2c0.2,0.2,0.5,0.4,0.7,0.5
            c0.1,0.1,0.2,0.1,0.3,0.2c0.3,0.2,0.7,0.4,1,0.6c0.1,0,0.2,0.1,0.2,0.1c0.3,0.2,0.6,0.3,0.9,0.4c0.1,0,0.1,0.1,0.2,0.1
            c0,0,0.1,0,0.1,0.1c0.3,0.1,0.7,0.3,1,0.4h0.1c0.4,0.1,0.7,0.2,1.1,0.3c0.1,0,0.3,0,0.4,0.1c0.3,0,0.5,0.1,0.8,0.1
            c0.1,0,0.3,0,0.4,0c0.4,0,0.7,0.1,1.1,0.1l0,0l0,0l0,0l0,0c0.4,0,0.8,0,1.1-0.1c0.1,0,0.3,0,0.4,0c0.3,0,0.6-0.1,0.8-0.1
            c0.1,0,0.3,0,0.4-0.1c0.4-0.1,0.8-0.2,1.1-0.3c0.1,0,0.1,0,0.2-0.1c0.3-0.1,0.7-0.2,1-0.4c0.1,0,0.1,0,0.2-0.1
            c0.1,0,0.1-0.1,0.2-0.1c0.3-0.1,0.6-0.3,0.9-0.5c0.1,0,0.1-0.1,0.2-0.1c0.3-0.2,0.7-0.4,1-0.6c0.1-0.1,0.2-0.1,0.3-0.2
            c0.2-0.2,0.5-0.3,0.7-0.5c0.1-0.1,0.2-0.2,0.3-0.2c0.3-0.3,0.6-0.5,0.8-0.8l0,0c0.3-0.3,0.5-0.6,0.8-0.9c0.1-0.1,0.1-0.2,0.2-0.3
            c0.2-0.2,0.4-0.5,0.5-0.7c0.1-0.1,0.1-0.2,0.2-0.3c0.2-0.3,0.3-0.5,0.5-0.8c0-0.1,0.1-0.2,0.1-0.2c0.2-0.3,0.3-0.7,0.5-1
            l189.6-458.4c0.3-0.8,0.6-1.7,0.8-2.6c0.1-0.3,0.1-0.7,0.1-1c0-0.1,0-0.2,0-0.3c0-0.4,0-0.7,0.1-1.1c0-0.1,0-0.2,0-0.2
            C487.1,14.665,487.1,14.365,487.1,14.065z M48.6,203.365l370.6-153l-217.8,217.7L48.6,203.365z M284,438.765l-64-151.1l215.3-215.2
            L284,438.765z"/>
    </g>
    </svg>`;
    const stream = `<svg fill="#000000" width="800px" height="800px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">
                <title>signal-stream</title>
                <path d="M16 11.75c-2.347 0-4.25 1.903-4.25 4.25s1.903 4.25 4.25 4.25c2.347 0 4.25-1.903 4.25-4.25v0c-0.003-2.346-1.904-4.247-4.25-4.25h-0zM16 17.75c-0.966 0-1.75-0.784-1.75-1.75s0.784-1.75 1.75-1.75c0.966 0 1.75 0.784 1.75 1.75v0c-0.001 0.966-0.784 1.749-1.75 1.75h-0zM3.25 16c0.211-3.416 1.61-6.471 3.784-8.789l-0.007 0.008c0.223-0.226 0.361-0.536 0.361-0.879 0-0.69-0.56-1.25-1.25-1.25-0.344 0-0.655 0.139-0.881 0.363l0-0c-2.629 2.757-4.31 6.438-4.506 10.509l-0.001 0.038c0.198 4.109 1.879 7.79 4.514 10.553l-0.006-0.006c0.226 0.228 0.54 0.369 0.886 0.369 0.69 0 1.249-0.559 1.249-1.249 0-0.346-0.141-0.659-0.368-0.885l-0-0c-2.173-2.307-3.573-5.363-3.774-8.743l-0.002-0.038zM9.363 16c0.149-2.342 1.109-4.436 2.6-6.026l-0.005 0.005c0.224-0.226 0.363-0.537 0.363-0.88 0-0.69-0.56-1.25-1.25-1.25-0.345 0-0.657 0.139-0.883 0.365l0-0c-1.94 2.035-3.179 4.753-3.323 7.759l-0.001 0.028c0.145 3.032 1.384 5.75 3.329 7.79l-0.005-0.005c0.226 0.228 0.54 0.369 0.886 0.369 0.69 0 1.249-0.559 1.249-1.249 0-0.346-0.141-0.659-0.368-0.885l-0-0c-1.49-1.581-2.451-3.676-2.591-5.993l-0.001-0.027zM26.744 5.453c-0.226-0.227-0.54-0.368-0.886-0.368-0.691 0-1.251 0.56-1.251 1.251 0 0.345 0.139 0.657 0.365 0.883l-0-0c2.168 2.31 3.567 5.365 3.775 8.741l0.002 0.040c-0.21 3.417-1.609 6.471-3.784 8.789l0.007-0.008c-0.224 0.226-0.362 0.537-0.362 0.88 0 0.691 0.56 1.251 1.251 1.251 0.345 0 0.657-0.14 0.883-0.365l-0 0c2.628-2.757 4.308-6.439 4.504-10.509l0.001-0.038c-0.198-4.108-1.878-7.79-4.512-10.553l0.006 0.007zM21.811 8.214c-0.226-0.224-0.537-0.363-0.881-0.363-0.69 0-1.25 0.56-1.25 1.25 0 0.343 0.138 0.653 0.361 0.879l-0-0c1.486 1.585 2.447 3.678 2.594 5.992l0.001 0.028c-0.151 2.343-1.111 4.436-2.601 6.027l0.005-0.005c-0.224 0.226-0.362 0.537-0.362 0.88 0 0.691 0.56 1.251 1.251 1.251 0.345 0 0.657-0.14 0.883-0.365l-0 0c1.939-2.036 3.178-4.754 3.323-7.759l0.001-0.028c-0.145-3.033-1.385-5.751-3.331-7.791l0.005 0.005z"></path>
                </svg>`;

    const location = `<svg fill="#000000" width="800px" height="800px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">
                          <path d="M16.114-0.011c-6.559 0-12.114 5.587-12.114 12.204 0 6.93 6.439 14.017 10.77 18.998 0.017 0.020 0.717 0.797 1.579 0.797h0.076c0.863 0 1.558-0.777 1.575-0.797 4.064-4.672 10-12.377 10-18.998 0-6.618-4.333-12.204-11.886-12.204zM16.515 29.849c-0.035 0.035-0.086 0.074-0.131 0.107-0.046-0.032-0.096-0.072-0.133-0.107l-0.523-0.602c-4.106-4.71-9.729-11.161-9.729-17.055 0-5.532 4.632-10.205 10.114-10.205 6.829 0 9.886 5.125 9.886 10.205 0 4.474-3.192 10.416-9.485 17.657zM16.035 6.044c-3.313 0-6 2.686-6 6s2.687 6 6 6 6-2.687 6-6-2.686-6-6-6zM16.035 16.044c-2.206 0-4.046-1.838-4.046-4.044s1.794-4 4-4c2.207 0 4 1.794 4 4 0.001 2.206-1.747 4.044-3.954 4.044z"></path>
                      </svg>`;  
            
    const settings = `<svg fill="#000000" width="800px" height="800px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">
                <path d="M30.015 12.97l-2.567-0.569c-0.2-0.64-0.462-1.252-0.762-1.841l1.389-2.313c0.518-0.829 0.78-2.047 0-2.829l-1.415-1.414c-0.78-0.781-2.098-0.64-2.894-0.088l-2.251 1.434c-0.584-0.303-1.195-0.563-1.829-0.768l-0.576-2.598c-0.172-0.953-1.005-1.984-2.11-1.984h-2c-1.104 0-1.781 1.047-2 2l-0.642 2.567c-0.678 0.216-1.328 0.492-1.948 0.819l-2.308-1.47c-0.795-0.552-2.114-0.692-2.894 0.088l-1.415 1.414c-0.781 0.782-0.519 2 0 2.828l1.461 2.435c-0.274 0.552-0.517 1.123-0.705 1.72l-2.566 0.569c-0.953 0.171-1.984 1.005-1.984 2.109v2c0 1.105 1.047 1.782 2 2l2.598 0.649c0.179 0.551 0.404 1.080 0.658 1.593l-1.462 2.438c-0.518 0.828-0.78 2.047 0 2.828l1.415 1.414c0.78 0.782 2.098 0.64 2.894 0.089l2.313-1.474c0.623 0.329 1.277 0.608 1.96 0.823l0.64 2.559c0.219 0.953 0.896 2 2 2h2c1.105 0 1.938-1.032 2.11-1.985l0.577-2.604c0.628-0.203 1.23-0.459 1.808-0.758l2.256 1.438c0.796 0.552 2.114 0.692 2.895-0.089l1.415-1.414c0.78-0.782 0.518-2 0-2.828l-1.39-2.317c0.279-0.549 0.521-1.12 0.716-1.714l2.599-0.649c0.953-0.219 2-0.895 2-2v-2c0-1.104-1.031-1.938-1.985-2.11zM30.001 16.939c-0.085 0.061-0.245 0.145-0.448 0.192l-3.708 0.926-0.344 1.051c-0.155 0.474-0.356 0.954-0.597 1.428l-0.502 0.986 1.959 3.267c0.125 0.2 0.183 0.379 0.201 0.485l-1.316 1.314c-0.127-0.040-0.271-0.092-0.341-0.14l-3.292-2.099-1.023 0.529c-0.493 0.256-0.999 0.468-1.503 0.631l-1.090 0.352-0.824 3.723c-0.038 0.199-0.145 0.36-0.218 0.417h-1.8c-0.061-0.085-0.145-0.245-0.191-0.448l-0.921-3.681-1.066-0.338c-0.549-0.173-1.097-0.404-1.63-0.684l-1.028-0.543-3.293 2.099c-0.135 0.091-0.279 0.143-0.409 0.143l-1.311-1.276c0.018-0.104 0.072-0.274 0.181-0.449l2.045-3.408-0.487-0.98c-0.227-0.462-0.407-0.895-0.547-1.325l-0.343-1.052-3.671-0.918c-0.231-0.052-0.398-0.139-0.485-0.2v-1.86c0.001 0.001 0.002 0.001 0.005 0.001 0.034 0 0.198-0.117 0.335-0.142l3.772-0.835 0.346-1.103c0.141-0.449 0.333-0.917 0.588-1.43l0.487-0.98-2.024-3.373c-0.125-0.201-0.184-0.38-0.201-0.485l1.315-1.314c0.128 0.041 0.271 0.093 0.34 0.14l3.354 2.138 1.027-0.542c0.527-0.278 1.073-0.507 1.622-0.682l1.063-0.338 0.912-3.649c0.053-0.231 0.138-0.398 0.2-0.485h1.859c-0.014 0.020 0.115 0.195 0.142 0.339l0.84 3.794 1.089 0.352c0.511 0.165 1.023 0.38 1.523 0.639l1.023 0.532 3.224-2.053c0.135-0.092 0.279-0.143 0.409-0.143l1.313 1.276c-0.017 0.104-0.072 0.276-0.181 0.45l-1.98 3.296 0.505 0.988c0.273 0.533 0.48 1.033 0.635 1.529l0.346 1.104 3.697 0.82c0.224 0.041 0.398 0.171 0.434 0.241zM16.013 9.99c-3.321 0-6.023 2.697-6.023 6.010s2.702 6.010 6.023 6.010 6.023-2.697 6.023-6.009c0-3.313-2.702-6.010-6.023-6.010zM16 20c-2.205 0-4-1.794-4-4s1.794-4 4-4c2.206 0 4 1.794 4 4s-1.794 4-4 4z"></path>
            </svg>`;        
                
    const icons = {
          VPN: (props) => <SvgXml xml={plane} width="25" height="25" {...props}/>,
          Stream: (props) => <SvgXml xml={stream} width="25" height="25" {...props}/>,
          Location: (props) => <SvgXml xml={location} width="25" height="25" {...props}/>,
          Settings: (props) => <SvgXml xml={settings} width="25" height="25" {...props}/>,
        };

    return (
    <View style={styles.bottom}>
      <View style={styles.tapbar}>
        {state.routes.map((route, index) => {
          const { options } = descriptors[route.key];
          const label =
            options.tabBarLabel !== undefined
              ? options.tabBarLabel
              : options.title !== undefined
                ? options.title
                : route.name;

        

          const isFocused = state.index === index;

          const onPress = () => {
            const event = navigation.emit({
              type: 'tabPress',
              target: route.key,
              canPreventDefault: true,
            });

            if (!isFocused && !event.defaultPrevented) {
              navigation.navigate(route.name, route.params);
            }
          };

          const onLongPress = () => {
            navigation.emit({
              type: 'tabLongPress',
              target: route.key,
            });
          };

          return (
            <PlatformPressable
              key={route.key}
              style={styles.tapBarItems}
              href={buildHref(route.name, route.params)}
              accessibilityState={isFocused ? { selected: true } : {}}
              accessibilityLabel={options.tabBarAccessibilityLabel}
              testID={options.tabBarButtonTestID}
              onPress={onPress}
              onLongPress={onLongPress}
            >
              {
                icons[route.name]({
                  fill: isFocused ? colors.primary : colors.text
                })
              }
              <Text style={{ color: isFocused ? colors.primary : colors.text }}>
                {label}
              </Text>
            </PlatformPressable>
          );
        })}
      </View>
    </View>
  );
}

const styles = StyleSheet.create({
    bottom: {
        position: 'absolute',
        bottom: 25,
        width: '100%', 
        height: 90, 
        display: 'flex',
        flexDirection: 'row',
        justifyContent: 'center',
        alignItems: 'center',
    },

    tapbar: {
      width: '85%',
      height: '100%',
      display: 'flex',
      flexDirection: 'row',
      justifyContent: 'center',
      alignItems: 'center',
      gap: 25,
      borderWidth: 2,
      borderRadius: 20,
      borderColor: 'green',
    },

    tapBarItems: {
        display: 'flex',
        flexDirection: 'column',
        justifyContent: 'center',
        alignItems: 'center'
    }
})

export default Tapbar;